<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LICENSECOIN‚Ñ¢ Wallet ‚Äî LICENSE G·ªêC‚Ñ¢</title>
  <meta name="description" content="Demo wallet for LICENSECOIN‚Ñ¢ (LCN) ‚Äî buy, sell, transfer, pay, export history. Not real money." />
  <style>
    :root{
      --bg:#0a0b0f; --panel:#11141a; --text:#eaeef5; --muted:#aab3c5;
      --gold:#f5d36a; --gold2:#ffd86b; --line:rgba(245, 211, 106, .16);
      --radius:16px; --shadow: 0 20px 70px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Inter,Arial;
         background:radial-gradient(1200px 600px at 50% -20%, #18202f 0%, #0b0e13 70%, #07090c 100%);
         color:var(--text)}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:980px;margin:32px auto;padding:0 20px}
    .hero{min-height:44vh;display:grid;place-items:center;text-align:center;position:relative}
    .brand{font-weight:800;letter-spacing:.02em;font-size:clamp(28px,4vw,42px)}
    .tag{opacity:.85;color:var(--muted);font-size:clamp(14px,2vw,18px)}
    .logo{width:min(340px,70vw);aspect-ratio:1/1;object-fit:contain;border-radius:22px;
          background:linear-gradient(180deg,#0f1a2e,#0b0e13);border:1px solid #1a2233;
          box-shadow: inset 0 0 0 1px rgba(255,255,255,.02), 0 40px 140px rgba(0,0,0,.55)}
    /* logo pulse sau 10s */
    .pulse{animation: pulse 3.2s ease-in-out 10s infinite}
    @keyframes pulse{
      0%{filter:drop-shadow(0 0 0 rgba(255,215,128,0))}
      50%{filter:drop-shadow(0 0 24px rgba(255,215,128,.35))}
      100%{filter:drop-shadow(0 0 0 rgba(255,215,128,0))}
    }

    .card{background:rgba(15,18,24,.7);backdrop-filter:blur(10px);
          border:1px solid var(--line); border-radius:var(--radius);
          box-shadow:var(--shadow); padding:22px}
    .title{font-weight:800;font-size:clamp(22px,3.2vw,28px);margin:10px 0 18px}

    .balance{display:flex;align-items:flex-end;gap:12px;margin:10px 0 18px}
    .balance .num{font-weight:900;font-size:clamp(44px,7vw,72px);letter-spacing:.01em}
    .balance .unit{color:var(--gold);font-weight:800}

    .row{display:flex;flex-wrap:wrap;gap:12px}
    .row > *{flex:1 1 160px}
    input,select,button,textarea{
      font:inherit;color:inherit;background:#0c1017;border:1px solid #202635;
      border-radius:12px;padding:12px 14px;outline:none;min-height:44px
    }
    input::placeholder{color:#6c788d}
    button{cursor:pointer;background:linear-gradient(180deg,#2a2f3a,#1a1f29);
      border:1px solid rgba(255,255,255,.06)}
    .btn-gold{background:linear-gradient(180deg,#3b2c12,#20180a);
      border:1px solid rgba(245,211,106,.35); color:var(--gold);font-weight:800}
    .btn-ghost{background:transparent}
    .pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;
      background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);color:#cdd6ea}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:14px}
    @media(min-width:780px){ .grid2{grid-template-columns:1fr 1fr} .grid3{grid-template-columns:repeat(3,1fr)}}

    /* Floating App Bar */
    .apps-nav{position:sticky;bottom:14px;left:0;right:0;display:flex;justify-content:center;z-index:70}
    .apps{display:flex;gap:14px;flex-wrap:wrap;max-width:1100px;padding:12px 14px;
      background:rgba(20,18,14,.52);border:1px solid rgba(245,211,106,.18);border-radius:16px;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.04), 0 20px 120px rgba(0,0,0,.45)}
    .apps a{padding:10px 18px;border-radius:999px;background:linear-gradient(180deg,#19160f,#0d0b07);
      border:1px solid rgba(245,211,106,.28);color:var(--gold);font-weight:800;white-space:nowrap}

    table{width:100%;border-collapse:separate;border-spacing:0;border:1px solid var(--line);
      border-radius:12px;overflow:hidden}
    th,td{padding:12px;border-bottom:1px solid rgba(255,255,255,.04)}
    th{background:rgba(255,255,255,.03);text-align:left}

    .small{font-size:13px}
    .right{text-align:right}
    .warn{color:#ffb4b4}
    .ok{color:#99e699}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- HERO -->
    <section class="hero">
      <div>
        <img class="logo pulse" src="assets/logo-licensecoin.png" alt="LICENSECOIN logo" onerror="this.style.display='none'">
        <div class="brand" style="margin-top:14px;">LICENSECOIN‚Ñ¢ Wallet</div>
        <div class="tag">Protect the Roots. Empower Humanity.</div>
      </div>
    </section>

    <!-- STATUS ROW -->
    <div class="row" style="margin-bottom:14px">
      <div class="pill"><strong>Status:</strong>&nbsp;<span id="status">Signed out</span></div>
      <div class="pill"><strong>User:</strong>&nbsp;<span id="who" class="muted">guest</span></div>
      <div class="pill"><strong>Rate:</strong>&nbsp;<span id="rateLabel">1 LCN = 1.00 USD</span></div>
      <div class="pill"><strong>ID:</strong>&nbsp;<span id="wid" class="muted">guest</span></div>
    </div>

    <!-- WALLET -->
    <section class="card">
      <div class="title">S·ªë d∆∞ hi·ªán t·∫°i</div>
      <div class="balance">
        <div id="bal" class="num">0</div><div class="unit">LCN</div>
      </div>

      <div class="row">
        <input id="amt" type="number" inputmode="decimal" placeholder="Nh·∫≠p s·ªë LCN ho·∫∑c USD‚Ä¶" />
        <button class="btn-gold" id="buyBtn">Buy</button>
        <button class="btn-gold" id="sellBtn">Sell</button>
        <button id="addBtn">+ N·∫°p</button>
        <button id="subBtn">‚àí R√∫t</button>
        <button id="bonusBtn">üéÅ Nh·∫≠n Bonus</button>
        <button id="resetBtn" class="btn-ghost">Reset</button>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="tradeBtn">‚ö° Trade nhanh</button>
        <button id="transferBtn">‚áÑ Transfer</button>
        <button id="payBtn">üí≥ Pay & Cards</button>
        <button id="historyBtn">üìú History</button>
        <button id="exportBtn">‚¨á Export JSON</button>
        <button id="rateBtn" class="btn-ghost">‚úé Set Rate</button>
      </div>

      <p class="small muted" style="margin-top:10px">
        Demo c·ª•c b·ªô (localStorage). ƒê√¢y <b>kh√¥ng</b> ph·∫£i ti·ªÅn th·∫≠t. Khi k·∫øt n·ªëi API th·∫≠t, m·ªçi t√°c v·ª• s·∫Ω ghi v√†o s·ªï c√°i tr√™n server + bƒÉm th·ªùi gian l√™n blockchain.
      </p>

      <!-- HISTORY -->
      <div id="historyWrap" style="display:none;margin-top:16px">
        <table>
          <thead><tr><th>Th·ªùi gian</th><th>Lo·∫°i</th><th class="right">¬±LCN</th><th class="right">S·ªë d∆∞</th><th>Ghi ch√∫</th></tr></thead>
          <tbody id="history"></tbody>
        </table>
      </div>
    </section>

    <!-- HOW-TO -->
    <section class="card" style="margin-top:16px">
      <div class="title">Guide ‚Ä¢ How to use</div>
      <ol class="small">
        <li>M·ªü <b>Vault</b> v√† ‚ÄúSign in‚Äù (name + email) ‚Üí quay l·∫°i Licensecoin ƒë·ªÉ g·∫Øn v√≠ theo t√†i kho·∫£n.</li>
        <li>Nh·∫≠p s·ªë v√† b·∫•m <b>Buy/Sell/N·∫°p/R√∫t</b>. Nh·∫•n <b>History</b> ƒë·ªÉ xem s·ªï giao d·ªãch; <b>Export JSON</b> ƒë·ªÉ t·∫£i v·ªÅ.</li>
        <li><b>Transfer</b> t·ªõi email kh√°c (ƒë√£ t·ª´ng ƒëƒÉng nh·∫≠p ·ªü Vault tr√™n m√°y h·ªç). <b>Pay & Cards</b> ch·ªâ l√† demo form thanh to√°n.</li>
        <li>N√∫t <b>Set Rate</b> ƒë·ªÉ ƒë·∫∑t t·ª∑ gi√° LCN‚áÑUSD trong demo (m·∫∑c ƒë·ªãnh 1.00).</li>
      </ol>
    </section>
  </div>

  <!-- Floating App Bar (standalone, kh√¥ng c·∫ßn goc-ui.js) -->
  <nav class="apps-nav" role="navigation" aria-label="Apps bar">
    <div class="apps">
      <a href="index.html">Apps</a>
      <a href="licensenetwork.html">LICENSENETWORK</a>
      <a href="licensecoin.html"><b>LICENSECOIN</b></a>
      <a href="vault.html">Vault</a>
      <a href="submit.html">Submit</a>
      <a href="payments.html">Pay & Cards</a>
      <a href="logout.html">Log out</a>
      <a href="#" id="openTim">AI TIM ‚ù§Ô∏è</a>
      <span class="pill" id="langPill">üåê <select id="langPick" aria-label="Translate">
        <option value="auto|en">English</option>
        <option value="auto|vi">Ti·∫øng Vi·ªát</option>
        <option value="auto|ja">Êó•Êú¨Ë™û</option>
        <option value="auto|ko">ÌïúÍµ≠Ïñ¥</option>
        <option value="auto|zh-CN">ÁÆÄ‰Ωì‰∏≠Êñá</option>
        <option value="auto|zh-TW">ÁπÅÈ´î‰∏≠Êñá</option>
        <option value="auto|es">Espa√±ol</option>
        <option value="auto|fr">Fran√ßais</option>
        <option value="auto|de">Deutsch</option>
        <option value="auto|pt">Portugu√™s</option>
        <option value="auto|ru">–†—É—Å—Å–∫–∏–π</option>
        <option value="auto|ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        <option value="auto|hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
        <option value="auto|th">‡πÑ‡∏ó‡∏¢</option>
      </select></span>
    </div>
  </nav>

  <!-- SCRIPTS -->
  <script>
  // ===== UTILITIES =====
  const $ = s => document.querySelector(s);
  const fmt = n => new Intl.NumberFormat().format(n);
  function id(){ return Math.random().toString(36).slice(2) }
  function now(){ return new Date().toISOString() }

  // Vault user (n·∫øu c√≥)
  function getUser(){
    try{ return JSON.parse(localStorage.getItem('goc_user')||'') }catch(e){ return null }
  }
  function uid(){ const u=getUser(); return u? (u.id || u.email || 'guest') : 'guest' }

  // Keys theo user
  function balKey(){ return `lcn_balance_${uid()}` }
  function ledgerKey(){ return `lcn_ledger_${uid()}` }
  function rateKey(){ return `lcn_rate` } // chung

  // Balance/ledger
  function loadBal(){ return parseInt(localStorage.getItem(balKey())||'0',10) }
  function saveBal(v){ localStorage.setItem(balKey(), String(v)) }
  function loadLedger(){ try{return JSON.parse(localStorage.getItem(ledgerKey())||'[]')}catch{return[]} }
  function saveLedger(arr){ localStorage.setItem(ledgerKey(), JSON.stringify(arr)) }

  // T·ª∑ gi√°
  function getRate(){ const r = localStorage.getItem(rateKey()); return r? Number(r) : 1.00 }
  function setRate(v){ localStorage.setItem(rateKey(), String(v)) }

  // Captcha nh·∫π
  function captcha(){
    const a = 1+Math.floor(Math.random()*9), b = 1+Math.floor(Math.random()*9);
    const x = prompt(`Captcha: ${a} + ${b} = ?`);
    return x !== null && Number(x) === (a+b);
  }

  // Ghi ledger
  function pushEntry(type, delta, note=''){
    const arr = loadLedger();
    const bal = loadBal() + delta;
    if(bal < 0) throw new Error('S·ªë d∆∞ kh√¥ng ƒë·ªß');
    const entry = { id:id(), t:now(), type, delta, bal, note, rate:getRate() };
    arr.unshift(entry); saveLedger(arr); saveBal(bal); return entry;
  }

  // Refresh UI
  function refresh(){
    const u = getUser();
    $('#status').textContent = u? 'Signed in' : 'Signed out';
    $('#who').textContent = u ? `${u.name||u.email||u.id}` : 'guest';
    $('#wid').textContent = uid();
    $('#bal').textContent = fmt(loadBal());
    $('#rateLabel').textContent = `1 LCN = ${getRate().toFixed(2)} USD`;
    renderHistory();
  }

  // History render
  function renderHistory(){
    const tbody = $('#history'); if(!tbody) return;
    const rows = loadLedger().map(e=>(
      `<tr>
        <td class="small">${new Date(e.t).toLocaleString()}</td>
        <td>${e.type}</td>
        <td class="right ${e.delta>=0?'ok':'warn'}">${e.delta>=0?'+':''}${fmt(e.delta)}</td>
        <td class="right">${fmt(e.bal)}</td>
        <td class="small muted">${e.note||''}${e.rate?` ‚Ä¢ @${e.rate.toFixed(2)} USD/LCN`:''}</td>
      </tr>`
    )).join('');
    tbody.innerHTML = rows || `<tr><td colspan="5" class="small muted">Ch∆∞a c√≥ giao d·ªãch.</td></tr>`;
  }

  // ===== ACTIONS =====
  function parseAmt(){
    const n = Number($('#amt').value||'0');
    if(!isFinite(n) || n<=0) throw new Error('Nh·∫≠p s·ªë > 0');
    return Math.floor(n);
  }

  // N·∫°p / R√∫t (demo)
  $('#addBtn').onclick = ()=>{ try{
    const n=parseAmt(); if(!captcha()) return;
    pushEntry('DEPOSIT', n, 'Manual deposit (demo)'); refresh();
  }catch(e){ alert(e.message) } };

  $('#subBtn').onclick = ()=>{ try{
    const n=parseAmt(); if(!captcha()) return;
    pushEntry('WITHDRAW', -n, 'Manual withdraw (demo)'); refresh();
  }catch(e){ alert(e.message) } };

  // Bonus
  $('#bonusBtn').onclick = ()=>{ pushEntry('BONUS', 50, 'Welcome bonus'); refresh() };

  // Reset
  $('#resetBtn').onclick = ()=>{ if(confirm('Reset v√≠ + l·ªãch s·ª≠ cho user hi·ªán t·∫°i?')){
    saveBal(0); saveLedger([]); refresh();
  }}

  // Buy/Sell theo USD/LCN (demo)
  function promptUSDorLCN(kind){
    const mode = prompt(`${kind}: nh·∫≠p 'usd' ƒë·ªÉ nh·∫≠p USD, 'lcn' ƒë·ªÉ nh·∫≠p LCN`, 'lcn') || 'lcn';
    return mode.toLowerCase()==='usd' ? 'usd' : 'lcn';
  }
  $('#buyBtn').onclick = ()=>{ try{
    const mode = promptUSDorLCN('Buy');
    const r = getRate();
    const n = parseAmt();
    const lcn = mode==='usd' ? Math.floor(n/r) : n;
    if(lcn<=0) throw new Error('S·ªë LCN qu√° nh·ªè');
    if(!captcha()) return;
    pushEntry('BUY', lcn, mode==='usd'?`Buy by ${n} USD`:`Buy ${lcn} LCN`);
    refresh();
  }catch(e){ alert(e.message) } };

  $('#sellBtn').onclick = ()=>{ try{
    const mode = promptUSDorLCN('Sell');
    const r = getRate();
    const n = parseAmt();
    const lcn = mode==='usd' ? Math.floor(n/r) : n;
    if(!captcha()) return;
    pushEntry('SELL', -lcn, mode==='usd'?`Sell for ${n} USD`:`Sell ${lcn} LCN`);
    refresh();
  }catch(e){ alert(e.message) } };

  // Trade nhanh (buy/sell toggle)
  $('#tradeBtn').onclick = ()=>{ try{
    const kind = (prompt("Trade: 'buy' ho·∫∑c 'sell'?", 'buy')||'buy').toLowerCase();
    if(kind!=='buy' && kind!=='sell') return;
    const n = parseAmt();
    if(!captcha()) return;
    pushEntry(kind.toUpperCase(), kind==='buy'? +n : -n, `Quick trade ${kind}`);
    refresh();
  }catch(e){ alert(e.message) } };

  // Transfer
  $('#transferBtn').onclick = ()=>{ try{
    const to = prompt('Email ng∆∞·ªùi nh·∫≠n (ƒë√£ ƒëƒÉng nh·∫≠p Vault ·ªü thi·∫øt b·ªã h·ªç):'); if(!to) return;
    const n = parseAmt(); if(!captcha()) return;
    // Tr·ª´ ng∆∞·ªùi g·ª≠i
    pushEntry('TRANSFER_OUT', -n, `to ${to}`);
    // C·ªông ng∆∞·ªùi nh·∫≠n (c√πng localStorage namespace theo email ‚Äî demo)
    const rid = to;
    const rBalKey = `lcn_balance_${rid}`;
    const rLedKey = `lcn_ledger_${rid}`;
    const rBal = parseInt(localStorage.getItem(rBalKey)||'0',10) + n;
    localStorage.setItem(rBalKey, String(rBal));
    const rLed = (()=>{try{return JSON.parse(localStorage.getItem(rLedKey)||'[]')}catch{return[]}})();
    rLed.unshift({id:id(), t:now(), type:'TRANSFER_IN', delta:+n, bal:rBal, note:`from ${uid()}`, rate:getRate()});
    localStorage.setItem(rLedKey, JSON.stringify(rLed));
    refresh(); alert('ƒê√£ transfer (demo).');
  }catch(e){ alert(e.message) } };

  // Pay (demo)
  $('#payBtn').onclick = ()=>{ try{
    const bill = prompt('Nh·∫≠p m√¥ t·∫£ h√≥a ƒë∆°n / ng∆∞·ªùi nh·∫≠n:');
    if(!bill) return;
    const n = parseAmt(); if(!captcha()) return;
    pushEntry('PAY', -n, `Pay: ${bill}`); refresh();
  }catch(e){ alert(e.message) } };

  // History toggle
  $('#historyBtn').onclick = ()=>{ const el=$('#historyWrap'); el.style.display = el.style.display==='none'?'block':'none' }

  // Export JSON
  $('#exportBtn').onclick = ()=>{
    const data = { user: uid(), balance: loadBal(), rate:getRate(), history: loadLedger() };
    const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
    a.download = `licensecoin_${uid()}_${Date.now()}.json`; a.click();
  }

  // Set Rate
  $('#rateBtn').onclick = ()=>{
    const v = Number(prompt('Nh·∫≠p t·ª∑ gi√° (USD cho 1 LCN):', String(getRate())));
    if(isFinite(v) && v>0){ setRate(v); refresh() }
  }

  // AI Tim (placeholder)
  $('#openTim').onclick = (e)=>{ e.preventDefault(); alert('AI TIM ‚ù§Ô∏è ‚Äî t√≠ch h·ª£p chat ·ªü b·∫£n k·∫ø ti·∫øp.'); }

  // Translator
  (function(){
    // Khi ch·ªçn, ch·∫°y Google Translate script
    const pick = $('#langPick');
    function loadSaved(){
      const v = (document.cookie.match(/(?:^|;)\s*goc_lang=([^;]+)/)||[])[1];
      if(v) pick.value = decodeURIComponent(v);
    }
    function setCookie(name,value){ document.cookie = `${name}=${encodeURIComponent(value)}; path=/; max-age=31536000` }
    pick.addEventListener('change', e=>{
      setCookie('goc_lang', pick.value);
      // g·ªçi translate
      const parts = pick.value.split('|');
      const lang = parts[1]||'en';
      if(window.google && window.google.translate && window.google.translate.TranslateElement){
        new google.translate.TranslateElement({pageLanguage:'en', includedLanguages:'', autoDisplay:false}, 'google_translate_element');
        const cb = document.querySelector('.goog-te-combo'); if(cb){ cb.value=lang; cb.dispatchEvent(new Event('change')) }
      }
    });
    loadSaved();
    window.googleTranslateElementInit = function(){
      new google.translate.TranslateElement({pageLanguage:'en', autoDisplay:false}, 'google_translate_element');
      const cb = document.querySelector('.goog-te-combo'); if(cb){
        const saved = (document.cookie.match(/(?:^|;)\s*goc_lang=([^;]+)/)||[])[1];
        if(saved){ cb.value=(saved.split('|')[1]||'en'); cb.dispatchEvent(new Event('change')) }
      }
    };
    const s=document.createElement('script'); s.src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
    document.head.appendChild(s);
  })();

  // Kh·ªüi ƒë·ªông
  if(localStorage.getItem(balKey())===null){ saveBal(150) } // seed demo
  refresh();
  </script>

  <!-- (T√πy ch·ªçn) Global UI n·∫øu c√≥ s·∫µn trong repo -->
  <script src="goc-ui.js"></script>
  <div id="google_translate_element" style="position:absolute;left:-9999px"></div>
</body>
</html>
